import{_ as t,r as p,o as e,c as o,b as n,e as c,w as l,d as s,a as i}from"./app.5331c54f.js";const u={},r=n("h1",{id:"图层加载",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#图层加载","aria-hidden":"true"},"#"),s(" 图层加载")],-1),k=i(`<p><code>layerUtil</code> 是 <code>layer</code> 的部分默认配置</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  outerColors<span class="token punctuation">,</span>
  layerDefaultOption<span class="token punctuation">,</span>
  layerHeatDefaultOption<span class="token punctuation">,</span>
  layerRasterDefaultOption<span class="token punctuation">,</span>
  layerExtrusionDefaultOption<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../util/layerUtil&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 图层加工工厂</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LayerFactory</span> <span class="token punctuation">{</span>
  map<span class="token punctuation">;</span>
  layers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  SourceFactory<span class="token punctuation">;</span> <span class="token comment">/*源头点位加工工厂*/</span>
  layerOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">map<span class="token punctuation">,</span> layers<span class="token punctuation">,</span> SourceFactory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> map<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers <span class="token operator">=</span> layers<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory <span class="token operator">=</span> SourceFactory<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>outerColors <span class="token operator">=</span> outerColors<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   *
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">data</span> Array
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">layerOption</span> 图层配置
   */</span>
  <span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> layerOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>layerDefaultOption<span class="token punctuation">,</span> <span class="token operator">...</span>layerOption <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">已添加过id为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的图层</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 先把点位生成source加载到地图上 可以传入不同的sourceName聚合不同类型的点位</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">addSources</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">cluster</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>cluster<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>cluster<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addClusterLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token parameter">layerId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">addHeatLayer</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> layerOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> layerHeatOption <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>layerHeatDefaultOption<span class="token punctuation">,</span> <span class="token operator">...</span>layerOption <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerHeatOption<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">已添加过id为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>layerHeatOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的图层</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">addSources</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> layerHeatDefaultOption<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layerHeatOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>layerHeatOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 添加栅格图层</span>
  <span class="token function">addRasterLayer</span><span class="token punctuation">(</span><span class="token parameter">tiles <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> layerOption</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> layerRasterOption <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>layerRasterDefaultOption<span class="token punctuation">,</span> <span class="token operator">...</span>layerOption <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerRasterOption<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">已添加过id为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>layerRasterOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的图层</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">addRasterSources</span><span class="token punctuation">(</span>tiles<span class="token punctuation">,</span> layerRasterOption<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layerRasterOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>layerRasterOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 添加建筑图层</span>
  <span class="token function">addExtrusionLayer</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> layerOption</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> layerExtrusionOption <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>layerExtrusionDefaultOption<span class="token punctuation">,</span> <span class="token operator">...</span>layerOption <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerExtrusionOption<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">已添加过id为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>layerExtrusionOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">的图层</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">addSources</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> layerExtrusionOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">tileUsage</span><span class="token operator">:</span> <span class="token string">&#39;sphere&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 瓦片用途</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layerExtrusionOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>layerExtrusionOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">addClusterLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 先把所有点位添加一个非聚合图层</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-unclustered</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span>
      <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;!has&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>layout<span class="token punctuation">,</span>
      <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;icon-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#ff0000&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;text-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-unclustered</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span>
      <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;!has&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>layout<span class="token punctuation">,</span>
      <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;icon-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#ff0000&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;text-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 添加聚合颜色图层</span>
    <span class="token keyword">const</span> clusterLayerList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createClusterLayer</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>outerColors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    clusterLayerList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">layerOption</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span>layerOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>layerOption<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//添加聚合数量图层</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-cluster-count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;symbol&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span>
      <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;text-field&#39;</span><span class="token operator">:</span> <span class="token string">&#39;{point_count}&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;text-size&#39;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;text-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;rgba(0,0,0,.75)&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;has&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>layers<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-cluster-count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;symbol&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span>
      <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;text-field&#39;</span><span class="token operator">:</span> <span class="token string">&#39;{point_count}&#39;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&#39;text-size&#39;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&#39;text-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;rgba(0,0,0,.75)&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;has&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 创建聚合图层</span>
  <span class="token function">createClusterLayer</span><span class="token punctuation">(</span><span class="token parameter">clusterColorList</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> clusterColorList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">color<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-cluster-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>i<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;circle&#39;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>layerOption<span class="token punctuation">.</span>source<span class="token punctuation">,</span>
        <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&#39;circle-color&#39;</span><span class="token operator">:</span> color<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token string-property property">&#39;circle-radius&#39;</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">filter</span><span class="token operator">:</span>
          i <span class="token operator">===</span> <span class="token number">0</span>
            <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token string">&#39;&gt;=&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> color<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            <span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token string">&#39;&gt;=&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> color<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                <span class="token punctuation">[</span><span class="token string">&#39;&lt;&#39;</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">point_count</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>outerColors<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token doc-comment comment">/**
   * 根据id更改图层的数据
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">layerId</span> 创建图层的id
   * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span><span class="token operator">*</span><span class="token punctuation">}</span></span> <span class="token parameter">pointData</span> 点位集合
   * 拿到图层中的source更改其sourceData
   */</span>
  <span class="token function">changeLayerByData</span><span class="token punctuation">(</span><span class="token parameter">layerId<span class="token punctuation">,</span> pointData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> sourceData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">createGeoJson</span><span class="token punctuation">(</span>pointData<span class="token punctuation">)</span><span class="token punctuation">;</span>
      source<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>sourceData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>layerId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-unclustered</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>layerId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-unclustered</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> source <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getSource</span><span class="token punctuation">(</span>layer<span class="token punctuation">.</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> sourceData <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>SourceFactory<span class="token punctuation">.</span><span class="token function">createGeoJson</span><span class="token punctuation">(</span>pointData<span class="token punctuation">)</span><span class="token punctuation">;</span>
      source<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>sourceData<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">showLayer</span><span class="token punctuation">(</span><span class="token parameter">layerId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">setLayoutProperty</span><span class="token punctuation">(</span>layerId<span class="token punctuation">,</span> <span class="token string">&#39;visibility&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">hideLayer</span><span class="token punctuation">(</span><span class="token parameter">layerId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">setLayoutProperty</span><span class="token punctuation">(</span>layerId<span class="token punctuation">,</span> <span class="token string">&#39;visibility&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;none&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">removeLayer</span><span class="token punctuation">(</span><span class="token parameter">layerId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">getLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">removeLayer</span><span class="token punctuation">(</span>layerId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="layerutil" tabindex="-1"><a class="header-anchor" href="#layerutil" aria-hidden="true">#</a> layerUtil</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 聚合图层颜色配置</span>
<span class="token keyword">const</span> outerColors <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(253, 156, 115, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(241, 211, 87, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(181, 226, 140, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> innerColors <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(241, 128, 23, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(240, 194, 12, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&#39;rgba(110, 204, 57, 0.6)&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 图层默认配置</span>
<span class="token keyword">const</span> layerDefaultOption <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;layerId&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;symbol&#39;</span><span class="token punctuation">,</span>
  <span class="token doc-comment comment">/**
   * fill球面面图层，line球面线图层，symbol球面图标图层，circle球面圆图层，heatmap热力图图层，
      extrusion建筑物图层，tracking历史实时轨迹图层，raster球面栅格图层，
      sprite球面动态路况粒子图层，
      symtracking车辆跟踪图层，histogram柱状图图层，3d-model三维模型图层，3d-tiles三维金字塔模型图层，
      background背景图层
   */</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;pointSource&#39;</span><span class="token punctuation">,</span> <span class="token comment">//数据源的唯一标识</span>
  <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;text-field&#39;</span><span class="token operator">:</span> <span class="token string">&#39;{title}&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;text-size&#39;</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;text-pitch-alignment&#39;</span><span class="token operator">:</span> <span class="token string">&#39;viewport&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;icon-image&#39;</span><span class="token operator">:</span> <span class="token string">&#39;{icon}&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;icon-pitch-alignment&#39;</span><span class="token operator">:</span> <span class="token string">&#39;viewport&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;icon-anchor&#39;</span><span class="token operator">:</span> <span class="token string">&#39;bottom&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;icon-size&#39;</span><span class="token operator">:</span> <span class="token number">0.4</span><span class="token punctuation">,</span>
    <span class="token literal-property property">visibility</span><span class="token operator">:</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">,</span> <span class="token comment">//值为“visible”表示该图层显示，为“none”表示隐藏该图层</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;icon-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#ff0000&#39;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&#39;text-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#fff&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minzoom</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxzoom</span><span class="token operator">:</span> <span class="token number">17.5</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cluster</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//是否是聚合图层</span>
  <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;!has&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;point_count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token doc-comment comment">/**
   * fliter表示从所有图层过滤出特定特征的图层，有以下几种过滤形式：
      a)	存在过滤：
      计算形式：[way, key]
      存在过滤主要有“has”、“!has”两种形式。
      例：
      [&quot;has&quot;, &quot;count&quot;]，表示过滤出存在属性&quot;count&quot;的所有的图层。
      [&quot;has&quot;,&quot;count&quot;]，表示过滤出不存在属性&quot;count&quot;的所有的图层。
      b)	比较过滤
      计算形式：[way, key, value]
      比较过滤主要有等于“= =”、大于“&gt;”、小于“&lt;”、不等于“!=”、大于等于“&gt;=”、小于等于“&lt;=”几种形式。
      例：
      [&quot;==&quot;, &quot;count&quot;, &quot;1000&quot;]，表示过滤出属性&quot;count&quot;值为1000的图层显示。
      c)	成员过滤：
      计算形式：[way, key, v0,v1，…，vn]
      成员过滤主要有等于&quot;in&quot;、&quot;!in&quot;两种形式。
      例：
      [&quot;in&quot;, &quot;name&quot;, &quot;point&quot;, &quot;fill&quot;, &quot;line&quot;]，表示过滤出属性&quot; name &quot;值为&quot;point&quot;, &quot;fill&quot;, &quot;line&quot;其中任一一个的图层。
   */</span>
  <span class="token literal-property property">outerColors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//聚合图层外圈颜色</span>
  <span class="token literal-property property">innerColors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//聚合图层内圈颜色</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> layerHeatDefaultOption <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;heatmapLayer&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;heatmap&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;heatmapSource&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">visibility</span><span class="token operator">:</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 一个热力图数据点的模糊范围，单位是像素，默认值30；要求：值大于等于1，可根据zoom level进行插值设置</span>
    <span class="token string-property property">&#39;heatmap-radius&#39;</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
    <span class="token comment">//一个热力图单个数据点的热力程度，默认值为1；要求：值大于等于0，支持使用property中某个的热力值</span>
    <span class="token string-property property">&#39;heatmap-weight&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">stops</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 用于统一控制热力值的强度，默认值1；要求：值大于等于0，可根据zoom level进行插值设置</span>
    <span class="token string-property property">&#39;heatmap-intensity&#39;</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token comment">// 表示热力图颜色阶梯，阶梯的值域范围为0-1，默认值为[&quot;interpolate&quot;,[&quot;linear&quot;],[&quot;heatmap-density&quot;],0,&quot;rgba(0, 0, 255, 0)&quot;,0.1,&quot;royalblue&quot;,0.3,&quot;cyan&quot;,0.5,&quot;lime&quot;,0.7,&quot;yellow&quot;,1,&quot;red&quot;]</span>
    <span class="token string-property property">&#39;heatmap-color&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&#39;interpolate&#39;</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">&#39;linear&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">[</span><span class="token string">&#39;heatmap-density&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token string">&#39;rgba(0, 0, 255, 0)&#39;</span><span class="token punctuation">,</span>
      <span class="token number">0.1</span><span class="token punctuation">,</span>
      <span class="token string">&#39;royalblue&#39;</span><span class="token punctuation">,</span>
      <span class="token number">0.3</span><span class="token punctuation">,</span>
      <span class="token string">&#39;cyan&#39;</span><span class="token punctuation">,</span>
      <span class="token number">0.5</span><span class="token punctuation">,</span>
      <span class="token string">&#39;lime&#39;</span><span class="token punctuation">,</span>
      <span class="token number">0.7</span><span class="token punctuation">,</span>
      <span class="token string">&#39;yellow&#39;</span><span class="token punctuation">,</span>
      <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token string">&#39;red&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 表示热力图的不透明度，默认值1；值域范围0-1，可根据zoom level进行插值设置</span>
    <span class="token string-property property">&#39;heatmap-opacity&#39;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 栅格图层默认配置</span>
<span class="token keyword">const</span> layerRasterDefaultOption <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;IMAGERY&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;raster&#39;</span><span class="token punctuation">,</span> <span class="token comment">//图层类型为&quot;raster&quot;</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;IMAGERY_SOURCE&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minzoom</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxzoom</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;raster-opacity&#39;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 建筑图层默认配置</span>
<span class="token keyword">const</span> layerExtrusionDefaultOption <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;ROUGHBUILDING&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;extrusion&#39;</span><span class="token punctuation">,</span> <span class="token comment">//图层类型为&quot;extrusion&quot;</span>
  <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;ROUGHBUILDING_SOURCE&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">minzoom</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token literal-property property">maxzoom</span><span class="token operator">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
  <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">visibility</span><span class="token operator">:</span> <span class="token string">&#39;visible&#39;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&#39;extrusion-pattern&#39;</span><span class="token operator">:</span> <span class="token string">&#39;Provincial_15_3&#39;</span><span class="token punctuation">,</span> <span class="token comment">//纹理,如果需要贴图，加入此行参数</span>
    <span class="token string-property property">&#39;extrusion-height&#39;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">property</span><span class="token operator">:</span> <span class="token string">&#39;levels&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;identity&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//高度</span>
    <span class="token string-property property">&#39;extrusion-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#0c3b70&#39;</span><span class="token punctuation">,</span> <span class="token comment">//颜色</span>
    <span class="token string-property property">&#39;extrusion-base&#39;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//基础高度</span>
    <span class="token string-property property">&#39;extrusion-opacity&#39;</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token comment">//基础高度</span>
    <span class="token string-property property">&#39;extrusion-translate-anchor&#39;</span><span class="token operator">:</span> <span class="token string">&#39;viewport&#39;</span><span class="token punctuation">,</span> <span class="token comment">//建筑物偏移锚点：值域map-正北，viewport--视野</span>
    <span class="token string-property property">&#39;extrusion-translate&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">//建筑物偏移</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  outerColors<span class="token punctuation">,</span>
  innerColors<span class="token punctuation">,</span>
  layerDefaultOption<span class="token punctuation">,</span>
  layerHeatDefaultOption<span class="token punctuation">,</span>
  layerRasterDefaultOption<span class="token punctuation">,</span>
  layerExtrusionDefaultOption<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4);function d(v,m){const a=p("RouterLink");return e(),o("div",null,[r,n("p",null,[c(a,{to:"/minemap/layer-load/#%E5%8A%A0%E8%BD%BD%E6%99%AE%E9%80%9A%E7%82%B9%E4%BD%8D"},{default:l(()=>[s("示例")]),_:1})]),k])}const b=t(u,[["render",d],["__file","index.html.vue"]]);export{b as default};
